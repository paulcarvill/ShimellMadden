<div id="navigation">
  <header>
    <%= render "shared/nav" %>
  </header>
  <div class="subnav">
    <nav>
      <% @collections.each do |coll| %>
        <a href="/collections/<%= coll.id %>" <%= if coll.id == @collection.id then "class=current" end %>><%= coll.name %></a>
      <% end %>
    </nav>
  </div>
</div>

<div id="items">
<section class="blog collection">
  <div class="collection-info">
    <h2><%= @collection.name %></h2>
    <p><%= @collection.description %></p>
  </div>

  <article style="position: relative">
    <div id="my-carousel">
    <% @items.each_with_index do |item, index| %>
      <div class="carousel<% if index == 0 %> first<% end %>">
        <img src="<%= item.image_style_one_url %>" />
      </div>
    <% end %>
    </div> <!-- end carousel -->

    <p class="carousel-prev"><img src="/assets/left-arrow.svg" alt="&laquo;" style="height:100%" /></p>
    <p class="carousel-next"><img src="/assets/right-arrow.svg" alt="&raquo;" style="height:100%" /></p>

    <div class="shopthis">
      <p><a href="#">Shop this item</a></p>
    </div>

    <p class="indicator"></p>
  </article>
</section>
</div>
  
<%= render "shared/footer" %>

<script type="text/javascript">
  $(function(){
    var current = 0;
    var items = [];

    $('#my-carousel div.carousel').each(function(){
      items.push(this)
    })

    $('.carousel-prev').click(function(){
      $(items[current]).fadeOut();
      current--;
      if (current == -1) {
        current = items.length - 1
      }
      $(items[current]).fadeIn();
      $('a.curr').removeClass('curr');
      $('.indicator a').eg(current).addClass('curr');
    })

    $('.carousel-next').click(function(){
      $(items[current]).fadeOut();
      current++;
      if (current == items.length) {
        current = 0
      }
      $(items[current]).fadeIn();

      $('a.curr').removeClass('curr');
      $('.indicator a').eq(current).addClass('curr');
    })

    var clas="";
    for (var i = 0; i < items.length; i++) {
      if (current == i) {
        clas = "curr";
      } else {
        clas = "";
      }
      $('.indicator').append('<a href="#" class="'+clas+'"><span>dot</span></a>');
    }

    $('article').css('height', items[current].offsetHeight);

    if(items.length < 2){
      $('.carousel-prev').remove();
      $('.carousel-next').remove();
    }
  });
</script>